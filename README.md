#  Проектная работа OTUS Linux Pro.

### Инфраструктурный стенд веб сайта на wordpress с репликациями.

Цель:
закрепить и продемонстрировать полученные знания и навыки;
создать веб-проект;
подготовить портфолио для работодателя;


Описание/Пошаговая инструкция выполнения задания.

Создание рабочего веб проект с развертыванием нескольких виртуальных машин должен отвечать следующим требованиям:

включен https;
основная инфраструктура в DMZ зоне;
файрвалл на входе;
сбор метрик и настроенный алертинг;
везде включен selinux;
организован централизованный сбор логов;
организован backup.

### Запускаем установку всего стека виртуальных машин.

Запускаем:[Vagranfile](https://github.com/PavelSergeevItem/otus_project/blob/main/Vagrantfile)
``` 
vagrant up
```
Эта команда запускает виртуальные машины, а так же их настройку с помощью Ansible.

![image](https://github.com/PavelSergeevItem/otus_project/blob/main/pictures/schema.jpg)
 Хосты | IP адрес
------| ---------
Router | 192.168.10.10
WEB (Nginx) | 192.168.10.20
MySQL (MASTER) | 192.168.10.30
MySQL (SLAVE) | 192.168.10.35
Log (rsyslog) | 192.168.10.60
Monitoring (Zabbix) | 192.168.10.50
Backup (NFS Server) | 192.168.10.90

### Описание хостов и их предназночения в стенде. 

Router - входящий роутер, который регулирует доступ в ДМЗ зону с внешней сети разрешая только передачу 
         443 порта на WEB сервер 192.168.10.20
        
WEB    - хост на, котором установлен стек: Nginx + PHP-FPM + Wordpress (БД находится на MySQL Master +  
       + Zabbix Agent (для мониторина Zabbix Server) + Rsyslog client (для передачи логов на Log сервер) 
MySQL Master - хост, на котором установлен MySQL в статусе Мастера в котором создана БД worpress. С него происходит репликация на MySQL Slave.

MySQL Slave - на него происходит репликация данных с Мастера + если мастер не доступен можно переключить работу WEB.
              Как переключить описано  [здесь](https://github.com/PavelSergeevItem/otus_project/blob/main/repl_mysql/README.md)
              
Log - из-за не хватки ресурсов поднят обычный Rsyslogдля сбора логов 

Zabbix - мониторинг хостов через агентов установленных на хостах
![image](https://github.com/PavelSergeevItem/otus_project/blob/main/pictures/zabbix.png)
       
NFS Server - на этом хосте поднят NFS Server и подключается как шара для бэкапов на хостах баз данных и WEB 
             в ручную (скрипты на WEB для бэкапа контента и его восстановления находятся в /home/vagrant) или по крону (можно 
             сделать добавив строчку при настроке через Ansible) - так же скрипты лежат на SQLMaster /home/vagrant для дополнительного 
             бэкапа и восстановления БД)       
        
### Доступ к службам.

> Для доступа к веб-проекту на Wordpress необходимо на хост машине прописать адрес роутера (Router): `192.168.10.10 otus.pupa.su.

Сервис | Адрес
------| ---------
Wordpress (Nginx+PHP-FPM) | https://192.168.10.20 (https://otus.pupa.su)
Zabbix | http://192.168.10.50/zabbix


SSL сертификат для сайта - сделан при помощи ресурса https://letsencrypt.org/
![image](https://github.com/)

